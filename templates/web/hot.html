{{ template "base.html" . }}
{{ define "title" }}
<title>è±†ç“£è¿‘æœŸçƒ­é—¨{{.name}}æ¨èï¼Œæ¯æ—¥æ›´æ–°é«˜åˆ†å¥½ç‰‡ - Moovie å…¨ç½‘å½±è§†èšåˆå¹³å°</title>
<meta name="description" content="ç²¾é€‰æ¥è‡ªè±†ç“£çš„çƒ­é—¨ç”µå½±æ¦œå•ï¼Œæ¯æ—¥å®æ—¶æ›´æ–°ã€‚æ¶µç›–æœ€æ–°é«˜åˆ†ç”µå½±ã€ç»å…¸å£ç¢‘å½±ç‰‡ã€çƒ­é—¨é™¢çº¿å¤§ç‰‡ä¸å†·é—¨ä½³ä½œï¼Œä¸ºä½ å‘ç°å€¼å¾—çœ‹çš„æ¯ä¸€éƒ¨ç”µå½±ã€‚">
<meta name="keywords" content="è±†ç“£çƒ­é—¨ç”µå½±, è±†ç“£é«˜åˆ†ç”µå½±, è±†ç“£ç”µå½±æ¨è, æœ€æ–°ç”µå½±æ¦œå•, å¥½çœ‹ç”µå½±, é«˜è¯„åˆ†å½±ç‰‡, çƒ­é—¨å½±ç‰‡, ç”µå½±æ’è¡Œæ¦œ">
{{end}}
{{ define "content" }}
<style>
.article-header {
    text-align: center;
    margin-top: 3rem;
    position: relative;
    padding-bottom: 0.5rem;
}
.article-header::after {
    content: '';
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 4px;
    background: var(--primary-color);
    border-radius: 2px;
}
.article-title {
    font-size: 2.5rem;
    color: var(--primary-color);
    margin-bottom: 1.5rem;
    line-height: 1.3;
}
.movie-rating{
    color: green;
}
</style>
<div class="breadcrumb">
    <a href="/">é¦–é¡µ</a>
    <span>/</span>
    <span>è±†ç“£çƒ­é—¨{{.name}}æ¨è</span>
</div>
<header class="article-header">
    <h1 class="article-title">è±†ç“£è¿‘æœŸçƒ­é—¨ {{.name}} æ¨è</h1>
</header>
<div id="load">
    <span class="cow-emoji" role="img" aria-label="Cow">ğŸ¬</span>
    <p>æ­£åœ¨è·å–æ•°æ®...</p>
</div>
<div class="movies" id="movies"></div>
<script>
async function getMovies() {
    const movies = document.getElementById("movies");
    const load = document.getElementById("load");
    try {
        const response = await sendRequest('GET', '/api/douban?type={{.name}}');

        if (response.code !== 200) {
            throw new Error(`HTTP error! status: ${response.msg}`);
        }
        const movies_data = await response.data;
        var movies_html = '';
        if(movies_data){
            for (let i = 0; i < movies_data.length; i++) {
                var item = movies_data[i];
                movies_html += `<div class="movie-card"><a href="/search?kw=${item.title}" title="æœç´¢ã€Š${item.title}ã€‹ç›¸å…³èµ„æº">
                    <div class="movie-poster">
                        <img loading="lazy" src="${item.cover}" alt="${item.title} Movie Poster" referrerPolicy="no-referrer">
                    </div>
                    <div class="movie-title">${item.title}</div>
                    <div class="movie-rating">
                        <span>â˜† ${item.rate}</span>
                        <a href="${item.url}" target="_blank">å»è±†ç“£ >>></a>
                    </div>
                </a></div>`
            }
        }
        if (movies_html == ""){
            load.innerHTML = `<span class="cow-emoji" role="img" aria-label="Cow">ğŸ¤”</span><p>æš‚æ—¶æ²¡æœ‰è·å–åˆ°å½±ç‰‡èµ„æºï¼Œè¿‡æ®µæ—¶é—´å†è¯•è¯•å‘—ï¼</p>`
        }else{
            load.style.display = "none";
        }
        movies.innerHTML = movies_html;
        console.log(movies_html);
    } catch (error) {
        console.error('åŠ è½½å½±è§†æ•°æ®å¤±è´¥:', error);
        showMsg('åŠ è½½å½±è§†æ•°æ®å¤±è´¥', "error")
        load.innerHTML = `<div id="load"><span class="cow-emoji" role="img" aria-label="Cow">ğŸ¤”</span><p>åŠ è½½å½±è§†æ•°æ®å¤±è´¥:${error}</p></div>`;
    }
}
// é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
document.addEventListener('DOMContentLoaded', function () {
    getMovies();
});
</script>
{{end}}